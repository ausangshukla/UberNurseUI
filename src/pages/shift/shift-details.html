<ion-header>

  <ion-navbar color="primary">
    <ion-title>Shift Details</ion-title>
  </ion-navbar>

</ion-header>


<ion-content>

  <ion-list>

    <div *ngIf="shift.can_manage != true">
      <img [src]="shift.user.image" style="max-height:300px;">

      <ion-item>
        <ion-row>
          <ion-col>
            {{shift.user.role}}:
          </ion-col>
          <ion-col>
            {{shift.user.first_name}}, {{shift.user.last_name}}
            <rating *ngIf="shift.user.rating_count < 10" [(ngModel)]="shift.user.rating" readOnly="true"></rating>
          </ion-col>
        </ion-row>
      </ion-item>


      <ion-item>
        <ion-row>
          <ion-col>
            Phone:
          </ion-col>
          <ion-col>
            <a href="tel:{{shift.user.phone}}">{{shift.user.phone}}</a>
          </ion-col>
        </ion-row>
      </ion-item>

    </div>

    <ion-item>
      <ion-row>
        <ion-col>
          Care Home:
        </ion-col>
        <ion-col>
          {{shift.care_home.name}}
        </ion-col>
      </ion-row>
    </ion-item>

    <ion-item>
      <ion-row>
        <ion-col>
          Start:
        </ion-col>
        <ion-col>
          {{shift.staffing_request.start_date | date: 'dd/MM/yyyy H:mm'}}
        </ion-col>
      </ion-row>
    </ion-item>

    <ion-item>
      <ion-row>
        <ion-col>
          End:
        </ion-col>
        <ion-col>
          {{shift.staffing_request.end_date | date: 'dd/MM/yyyy H:mm'}}
        </ion-col>
      </ion-row>
    </ion-item>

    <ion-item>
      <ion-row>
        <ion-col>
          Status:
        </ion-col>
        <ion-col>
          {{shift.response_status}}
        </ion-col>
      </ion-row>
    </ion-item>

    <ion-item *ngIf="shift.payment_status">
      <ion-row>
        <ion-col>
          Payment Status:
        </ion-col>
        <ion-col>
          {{shift.payment_status}}
        </ion-col>
      </ion-row>
    </ion-item>

    <ion-item *ngIf="shift.start_code">
      <ion-row>
        <ion-col>
          Start Code:
        </ion-col>
        <ion-col>
          {{shift.start_code}}
        </ion-col>
      </ion-row>
    </ion-item>

    <ion-item *ngIf="shift.start_code">
      <ion-row>
        <ion-col>
          Start Time:
        </ion-col>
        <ion-col>
          {{shift.start_date | date: 'dd/MM/yyyy H:mm'}}
        </ion-col>
      </ion-row>
    </ion-item>

    <ion-item *ngIf="shift.end_code">
      <ion-row>
        <ion-col>
          End Code:
        </ion-col>
        <ion-col>
          {{shift.end_code}}
        </ion-col>
      </ion-row>
    </ion-item>

    <ion-item *ngIf="shift.end_code">
      <ion-row>
        <ion-col>
          End Time:
        </ion-col>
        <ion-col>
          {{shift.end_date | date: 'dd/MM/yyyy H:mm'}}
        </ion-col>
      </ion-row>
    </ion-item>

    <ion-item *ngIf="shift.end_code">
      <ion-row>
        <ion-col>
          Worked:
        </ion-col>
        <ion-col>
          {{ (shift.minutes_worked / 60) | number:'.0-0' }} hrs {{(shift.minutes_worked % 60)}} mins
        </ion-col>
      </ion-row>
    </ion-item>

    <ion-item *ngIf="shift.end_code">
      <ion-row>
        <ion-col>
          Amount:
        </ion-col>
        <ion-col>
          {{shift.price | currency : 'GBP' : true}}
        </ion-col>
      </ion-row>
    </ion-item>

  </ion-list>

  <div *ngIf="shift.can_manage == true">
    <ion-row *ngIf="shift.response_status == 'Pending'">
      <ion-col>
        <button ion-button full color="secondary" (click)="acceptResponse(shift)">Accept</button>
      </ion-col>
      <ion-col>
        <button ion-button full color="primary" (click)="rejectResponse(shift)">Decline</button>
      </ion-col>
    </ion-row>

    <ion-row *ngIf="shift.start_code == null || shift.end_code == null">
      <ion-col *ngIf="shift.start_code == null">
        <button ion-button full color="primary" (click)="editShift(shift)">Add Start Code</button>
      </ion-col>
      <ion-col *ngIf="shift.start_code != null && shift.end_code == null">
        <button ion-button full color="primary" (click)="editShift(shift)">Add End Code</button>
      </ion-col>
    </ion-row>

    <ion-row *ngIf="shift.end_code != null">
      <ion-col *ngIf="shift.payment_status == 'Paid'">
        <button ion-button full color="primary" (click)="viewPayment(shift)">View Payment</button>
      </ion-col>
      <ion-col *ngIf="shift.care_home_rated != true">
        <button ion-button full color="primary" (click)="rate_care_home(shift)">Rate Care Home</button>
      </ion-col>
      <ion-col *ngIf="shift.care_home_rated == true">
        <button ion-button full color="primary" (click)="viewRatings(shift)">View Ratings</button>
      </ion-col>
    </ion-row>
  </div>

  <div *ngIf="shift.can_manage != true">
    <ion-row>
      <ion-col *ngIf="shift.payment_status == 'Paid'">
        <button ion-button full color="primary" (click)="viewPayment(shift)">View Payment</button>
      </ion-col>
      <ion-col *ngIf="shift.rated != true">
        <button ion-button full color="primary" (click)="rate_care_giver(shift)">Rate Care Giver</button>
      </ion-col>
      <ion-col *ngIf="shift.rated == true">
        <button ion-button full color="primary" (click)="viewRatings(shift)">View Ratings</button>
      </ion-col>
    </ion-row>
  </div>


</ion-content>