{"version":3,"sources":["../../src/pages/staffing-request/staffing-request-form/staffing-request-form.module.ts","../../src/pages/staffing-request/staffing-request-form/staffing-request-form.ts"],"names":[],"mappings":"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","file":"27.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { StaffingRequestForm } from './staffing-request-form';\n\n@NgModule({\n  declarations: [\n    StaffingRequestForm,\n   ],\n  imports: [\n    IonicPageModule.forChild(StaffingRequestForm),\n   ],\n  exports: [\n    StaffingRequestForm,\n   ]\n})\nexport class StaffingRequestFormModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/staffing-request/staffing-request-form/staffing-request-form.module.ts","import { IonicPage, NavController, NavParams, AlertController, ToastController, LoadingController } from 'ionic-angular';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { SimpleChanges, Component, ViewChild } from '@angular/core';\nimport * as moment from 'moment';\nimport { AngularTokenService } from 'angular-token';\nimport { StaffingRequestApi } from '../../../providers/staffing-request-api';\nimport { ResponseUtility } from '../../../providers/response-utility';\n\n@IonicPage()\n@Component({\n  selector: 'page-staffing-request-form',\n  templateUrl: 'staffing-request-form.html',\n})\nexport class StaffingRequestForm {\n\n  minStartDate: any;\n  maxStartDate: any;\n  minEndDate:any;\n  maxEndDate:any;\n  staffingRequest: {};\n  current_user: {};\n  care_home: {};\n  carers: {};\n\n  @ViewChild('signupSlider') signupSlider: any;\n\n  slideOneForm: FormGroup;\n  slideTwoForm: FormGroup;\n\n  submitAttempt: boolean = false;\n\n  constructor(public navCtrl: NavController,\n    private tokenService: AngularTokenService,\n    public navParams: NavParams,\n    public formBuilder: FormBuilder,\n    public loadingController: LoadingController,\n    public staffingRequestApi: StaffingRequestApi,\n    public respUtility: ResponseUtility) {\n\n    this.current_user = tokenService.currentUserData;  \n    this.care_home = this.current_user[\"care_home\"];\n      \n    this.staffingRequest = this.navParams.data;\n    this.staffingRequest[\"care_home_id\"] = this.current_user[\"care_home_id\"];\n       \n    this.minStartDate = new Date().toISOString();\n    this.maxStartDate = moment().add(1, 'year').toISOString();\n    this.minEndDate = new Date().toISOString();\n    this.maxEndDate = moment().add(1, 'year').toISOString();\n    \n\n    this.slideOneForm = formBuilder.group({\n\n      care_home_id: ['', Validators.compose([])],\n\n      agency_id: ['', Validators.compose([Validators.required])],\n\n      role: ['', Validators.compose([Validators.required])],\n\n      start_date: ['', Validators.compose([Validators.required])],\n\n      end_date: ['', Validators.compose([Validators.required])],\n\n      request_status: ['', Validators.compose([Validators.maxLength(30), Validators.pattern('[a-zA-Z ]*')])],\n\n      payment_status: ['', Validators.compose([Validators.maxLength(30), Validators.pattern('[a-zA-Z ]*')])],\n\n      start_code: ['', Validators.compose([Validators.maxLength(30), Validators.pattern('^\\\\d+$')])],\n\n      end_code: ['', Validators.compose([Validators.maxLength(30), Validators.pattern('^\\\\d+$')])],\n\n      notes: ['', Validators.compose([])],\n\n      po_for_invoice: [''],\n\n      preferred_carer_id: ['', Validators.compose([])],\n\n    });\n\n    this.slideTwoForm = formBuilder.group({\n\n\n    });\n\n    this.setPOValidators();\n\n  }\n\n  setPOValidators() {\n  \n    const po_for_invoideControl = this.slideOneForm.get('po_for_invoice');\n    \n    if (this.care_home[\"po_req_for_invoice\"]) {\n      po_for_invoideControl.setValidators([Validators.required]);\n    } else {\n      po_for_invoideControl.setValidators(null);\n    }\n\n  }\n\n  getCarers() {\n    console.log(\"getCarers Called\");\n    if(this.staffingRequest[\"role\"] && this.staffingRequest[\"agency_id\"]) {\n      this.staffingRequestApi.getCares(this.staffingRequest).subscribe(\n        carers => {\n          this.carers = carers;\n        }\n      )\n    }\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad StaffingRequestsForm');\n    this.respUtility.trackView(\"StaffingRequestForm\");\n\n    if (this.staffingRequest[\"start_date\"]) {\n      // Need to convert back to local time\n      this.staffingRequest[\"start_date\"] = moment(this.staffingRequest[\"start_date\"]).format();\n      this.staffingRequest[\"end_date\"] = moment(this.staffingRequest[\"end_date\"]).format();\n    }\n    else {\n      let start_of_day = moment().add(1, 'day').hour(8).minute(0);\n      this.staffingRequest[\"start_date\"] = start_of_day.format();;\n      let end_date = start_of_day.add(8, 'hours').format();\n      this.staffingRequest[\"end_date\"] = end_date;\n      console.log(`end date = ${end_date}`);\n    }\n\n    if(this.staffingRequest[\"start_code\"] == null) {\n      this.staffingRequest[\"start_code\"] = Math.floor(1000 + Math.random()*9000);\n    }\n\n    if(this.staffingRequest[\"end_code\"] == null) {\n      this.staffingRequest[\"end_code\"] = Math.floor(1000 + Math.random()*9000);\n    }\n\n    if(this.current_user[\"sister_care_homes\"] != null) {\n      this.staffingRequest[\"care_home_id\"] = this.current_user[\"care_home_id\"]\n    }\n\n    if(this.current_user[\"care_home_agencies\"] != null) {\n      this.staffingRequest[\"agency_id\"] = this.current_user[\"care_home_agencies\"][0][\"id\"];\n    }\n\n  }\n\n  confirmSave() {\n    this.respUtility.confirmAction(this.save.bind(this), null, \"Please check the shift details are correct. Note: Cancellation within 24 hours of start time will incur full shift charge to cover the candidates losses. Proceed?\");\n  }\n\n  save() {\n    this.respUtility.trackEvent(\"StaffingRequest\", \"Save\", \"click\");\n    this.submitAttempt = true;\n\n    if( moment(this.staffingRequest[\"start_date\"]).add(4, 'hours') > moment(this.staffingRequest[\"end_date\"]) ) {\n      console.log(\"start date > end date\");\n      this.slideOneForm.controls[\"end_date\"].setErrors({notValid:true});\n      return;\n    } else {\n      console.log(\"start date < end date\");\n      this.slideOneForm.controls[\"end_date\"].setErrors(null);      \n    }\n\n    //console.log(this.staffingRequest);\n    let loader = this.loadingController.create({\n      content: 'Saving ...'\n    });\n\n    if (!this.slideOneForm.valid) {\n\n    }\n    else {\n      this.submitAttempt = false;\n      loader.present();\n\n      if (this.staffingRequest[\"id\"]) {\n        this.staffingRequestApi.updateStaffingRequest(this.staffingRequest).subscribe(\n          staffingRequest => {\n            this.respUtility.showSuccess('Request saved successfully.');\n            this.navCtrl.pop();\n          },\n          error => {\n            this.respUtility.showFailure(error);\n            loader.dismiss();\n          },\n          () => { loader.dismiss(); }\n        );\n      } else {\n        this.staffingRequestApi.createStaffingRequest(this.staffingRequest).subscribe(\n          staffingRequest => {\n            this.respUtility.showSuccess('Request saved successfully. We will notify you when we fill the shift with a Care Giver/Nurse.');\n            this.navCtrl.pop();\n          },\n          error => {\n            this.respUtility.showFailure(error);\n            loader.dismiss();\n          },\n          () => { loader.dismiss() }\n        );\n      }\n    }\n  }\n\n  price(staffingRequest) {\n    this.respUtility.trackEvent(\"StaffingRequest\", \"Price\", \"click\");\n    //console.log(this.staffingRequest);\n    let loader = this.loadingController.create({\n      content: 'Getting Estimated Price ...'\n    });\n\n    loader.present();\n\n    this.staffingRequestApi.price(this.staffingRequest).subscribe(\n      staffingRequest => {\n        console.log(`care_home_base=${staffingRequest[\"care_home_base\"]}, audit=${staffingRequest[\"pricing_audit\"]}`);\n        this.staffingRequest[\"care_home_base\"] = staffingRequest[\"care_home_base\"]\n        this.staffingRequest[\"pricing_audit\"] = staffingRequest[\"pricing_audit\"];\n\n        // let msg = \"\";\n        // for (var propt in staffingRequest[\"pricing_audit\"]) {\n        //   msg += propt.split('_').join(' ') + ' = ' + staffingRequest[\"pricing_audit\"][propt] + \",\";\n        // }\n        this.respUtility.popup(\"Pricing\", `Estimated price: GBP ${staffingRequest[\"care_home_total_amount\"]}`);\n      },\n      error => {\n        this.respUtility.showFailure(error);\n        loader.dismiss();\n      },\n      () => { loader.dismiss(); }\n    );\n\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/staffing-request/staffing-request-form/staffing-request-form.ts"],"sourceRoot":""}